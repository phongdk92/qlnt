{% extends "base.html" %}
{% block content %}
<script>
function confirmDelete()
{
	return confirm("Bạn có chắc chắn xóa không?");
}
</script>


<table border=0 align = "center" width="100%">
	<tr>
        {% if pos > 0%}
            <td width="15%" align = "center"><a title="Cập nhật điểm danh theo lớp" href="{%url school.views.school_index  %}diemdanh/{{class.id}}">Điểm danh</a></td>                        

        {% endif %}
        
        
        {% if pos > 2%}            
            <td width="15%" align = "center"><a title="Đánh giá hạnh kiểm học sinh trong lớp" href="{%url school.views.school_index  %}hanhkiem/{{class.id}}">Hạnh Kiểm</a></td>                    
        {% endif %}
        
        {%if pos > 0%}
		<td width="15%" align = "center"><a title="Xem tất cả thông tin của của môn học trong lớp"  href = "{%url school.views.school_index  %}subjectPerClass/{{class.id}}">Quản lý môn học</a></td>
        {%endif%}
        
        {% if pos > 3 %}
            <td width="15%" align = "center"><a title="Nhập hoặc chỉnh sửa điểm của tất cả các môn trong lớp" href = "{%url school.views.school_index  %}markTable/{{class.id}}">Quản lý điểm</a></td>
            <td width="20%" align = "center"><a title="Tự động tính trung bình học lực của cả lớp" href = "{%url school.views.school_index  %}xepLoaiHlTheoLop/{{class.id}}">Tổng kết học lực</a></td>
            <td width="20%" align = "center">
            {% ifnotequal class.year_id.school_id.status 1 %}
                <a  title="Tự động xếp loại cả năm của lớp" href = "{%url school.views.school_index  %}xlCaNamTheoLop/{{class.id}}">Tổng kết cả năm</a>
            {% else %}
                <a title="Chức năng này đã bị vô hiệu hóa vì đang trong học kỳ I" >Tổng kết cả năm</a>
            {% endifnotequal  %}</td>
        {% endif %}
	</tr>
</table>

<h1 align = "center">Lớp {{class.name}} năm học {{class.year_id}}</h1>
<table class="styleA" width = "100%" >
    <tr>
		<th align="center" width="5%"> STT </th>
        <th align="center" width="25%"> <a href="{%url school.views.school_index  %}viewClassDetail/{{class.id}}/1/{{next_status}}/1">Họ & Tên </a></th>
        <th align="center" width="15%"> <a href="{%url school.views.school_index  %}viewClassDetail/{{class.id}}/2/{{next_status}}/1">Ngày sinh</a></th>
        <th align="center" width="10%"><a href="{%url school.views.school_index  %}viewClassDetail/{{class.id}}/3/{{next_status}}/1">Giới tính</a></th>
        <th align="center" width="10%"><a href="{%url school.views.school_index  %}viewClassDetail/{{class.id}}/4/{{next_status}}/1"> Ban Đăng kí </a></th>
        <th align="center" width="15%"><a href="{%url school.views.school_index  %}viewClassDetail/{{class.id}}/5/{{next_status}}/1">Ngày vào trường </a></th>
        <th align="center" width="10%"> Năm bắt đầu </th>
        {%if pos > 3%}
            <th width = "5%"></th>
        {%endif%}
    </tr>

    {% if message != None %}
    {{message}}
    {% endif %}

    {% for ss in studentList.object_list %}
    <tr>
        <td align="center" width="5%"> {{forloop.counter|add:base_order}} </td>
        {%if pos > 1 or student_id == ss.id%}
            <td align="center" width="25%"> <a title = "Xem toàn bộ thông tin chi tiết" href="{%url school.views.school_index  %}viewStudentDetail/{{ss.id}}">{{ss.last_name}} {{ss.first_name}} </a></td>
        {%else%}   
            <td align="center" width="25%"> {{ss.last_name}} {{ss.first_name}}</td>
        {%endif%}
        <td align="center" width="15%"> {{ss.birthday|date:"SHORT_DATE_FORMAT"}}</td>
        <td align="center" width="10%"> {{ss.sex}}</td>
        <td align="center" width="10%"> {{ss.ban_dk}} </td>
        <td align="center" width="15%"> {{ss.school_join_date|date:"SHORT_DATE_FORMAT"}} </td>
        <td align="center" width="10%"> {{ss.start_year_id}} </td>
        {%if pos > 3%}
        <td width="5%"><a href = "{%url school.views.school_index  %}deleteStudentInClass/{{ss.id}}" onclick="return confirmDelete();"> xóa</a></td>
         {%endif%}
    </tr>
    {% endfor %}
    
    {% if pos > 3%}
    <form action="/school/viewClassDetail/{{class.id}}/{{sort_type}}/{{sort_status}}/{{studentList.number}}" method="post">{% csrf_token %}
        <tr>
            {{ form.non_field_errors }}
			<td align="center" width="5%">
            <td align="center" width="25%">
                    {{form.first_name.errors }}
                    <p>{{ form.first_name }}</p>
            </td>

            <td align="center" width="15%">
                    {{ form.birthday.errors }}
                    <p>{{ form.birthday }}</p>
            </td>

            <td align="center" width="10%">
                    {{ form.sex.errors }}
                    <p>{{ form.sex }}</p>
            </td>

            <td align="center" width="10%">
                    {{form.ban_dk.errors }}
                    <p>{{ form.ban_dk }}</p>
            </td>

            <td align="center" width="15%">
                    {{ form.school_join_date.errors }}
                    <p>{{ form.school_join_date }}</p>                   
            </td>

            <td align="center" width="10%">
                    {{ form.start_year_id.errors }}
                    <p>{{ form.start_year_id }}</p>                   
            </td>         
        </tr>
</table>
<table width="100%">
        <tr>
        		<td width = "5%" align = "left"><input type ="submit" value="Thêm"/></td>
        		<td align = "right"> <a href = ""> Xuất ra Excel </a> </td>
			</form>
        </tr>
</table>
{%endif%}
<table border = "0" width = "100%">
	<tr boder = 0>
		<td width = "100%" colspan = 9 align = "right">
		<div class = "pagination">
		<span class = "step-links">
			{% if studentList.has_previous %}
				<a href = "{%url school.views.school_index  %}viewClassDetail/{{class.id}}/{{sort_type}}/{{sort_status}}/{{studentList.previous_page_number}}"> Trang trước </a>
			{% endif %}
			
			<span class = "current">
				Trang {{studentList.number}} trên {{studentList.paginator.num_pages}}.
			</span>
			
			{% if studentList.has_next %}
				<a href = "{%url school.views.school_index  %}viewClassDetail/{{class.id}}/{{sort_type}}/{{sort_status}}/{{studentList.next_page_number}}"> Trang sau </a>
			{% endif %}
		</span>
		</div>
		</td>
	</tr>
</table>

{% endblock %}
