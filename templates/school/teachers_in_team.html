{% block content %}
    <script>
        $(document).ready(function() {
            $("select[name=team_id]").each(function() {
                $(this).change(function() {
                    var id = $(this).parents("tr").attr('class').split(' ')[0];
                    var team = $(this).val();
                    var p = $(this).parents("tr");
                    var data = { id: id, team:team, request_type:'team'};
                    var arg = { type:"POST",
                        url:"school/teachers_in_team/{{ team.id }}",
                        data: data,
                        datatype:"json",
                        success:function(){
                            p.empty();
                        }
                    };
                    $.ajax(arg);
                    return false;

                });
            });
            $("select[name=group_id]").each(function() {
                $(this).change(function() {
                    var id = $(this).parents("tr").attr('class').split(' ')[0];
                    var group = $(this).val();
                    var data = { id: id, group:group, request_type:'group'};
                    var arg = { type:"POST",
                        url:"school/teachers_in_team/{{ team.id }}",
                        data: data,
                        datatype:"json",
                        success:function(){
                        }
                    };
                    $.ajax(arg);
                    return false;

                });
            });
            var $d1 = $("#d{{team.id}}").dialog({
                autoOpen: false,
                modal: true,
                buttons: {
                    Thêm: function() {
                        addgroup();
                        $(this).dialog("close");
                    },
                    Hủy: function() {
                        $(this).dialog("close");
                    }
                },
                close: function() {
                    $("#ag{{team.id}}").reset();
                }
            });
            $("#add_group{{team.id}}").click(function() {
                $d1.dialog("open");
            });
            function addgroup() {
                var data = { 'name' : $("#group_title{{team.id}}").val(),'team_id':{{team.id}}, request_type:'addGroup'};
                var arg = { type:"POST",
                    url:"",
                    data: data,
                    datatype:"json",
                    success: function(response) {
                        $('.ui-tabs-panel:visible').html(response);
                    }
                };
                $.ajax(arg);
                return false;
            }
        });
    </script>
    <button id="add_group{{team.id}}" class="ggButton"> Thêm nhóm </button>
    <div id="d{{team.id}}" title="Thêm tổ mới">
        <form id="ag{{team.id}}">
            <label for="tab_title">Tên nhóm</label>
            <input type="text" name="tab_title" id="group_title{{team.id}}" value="" class="ui-widget-content ui-corner-all"/>
        </form>
    </div>
    <h2>Danh sách giáo viên {{ team }}</h2>
    <table class="styleA" width="100%">
        <tr>
            <th align="center" width="5%"> STT</th>
            <th align="center" width="15%">Họ tên</th>
            <th align="center" width="10%">Ngày sinh</th>
            <th align="center" width="20%"> Nơi sinh</th>
            <th align="center" width="10%">Giới tính</th>
            <th align="center" width="15%">Tổ</th>
            <th align="center" width="15%">Nhóm</th>
            {% if pos > 3 %}
                <th width="10%"></th>
            {% endif %}
        </tr>

        {% if message != None %}
            {{ message }}
        {% endif %}

        {% for ss, f in list %}
            <tr class="{{ ss.id }}">
                <td align="center" width="5%">{{ forloop.counter }}</td>
                <td align="center" width="15%">
                    {% if pos > 3 or teacher_id == ss.id %}
                        <a href="{%url school.views.school_index  %}viewTeacherDetail/{{ss.id}}">
                            {{ ss.last_name }} {{ ss.first_name }} </a>
                    {% else %}
                        {{ ss.last_name }} {{ ss.first_name }}
                    {% endif %}
                </td>

                <td align="center" width="10%"> {{ ss.birthday|date:"SHORT_DATE_FORMAT" }}</td>
                <td align="center" width="20%"> {{ ss.birth_place }}</td>
                <td align="center" width="10%"> {{ ss.sex }} </td>
                {% if pos > 3 %}
                    <td align="center" width="15%"> {{ f.team_id }} </td>
                    <td align="center" width="15%"> {{ f.group_id }} </td>
                    <td align="center" width="10%"><a
                            href="{%url school.views.school_index  %}deleteTeacher/{{ss.id}}/{{team.id}}"
                            title="Xóa giáo viên" class="ggButton delete""> xóa </a></td>
                {% else %}
                    <td align="center" width="15%"> {{ ss.team_id }} </td>
                    <td align="center" width="15%"> {{ ss.group_id }} </td>
                {% endif %}
            </tr>
        {% endfor %}

    </table>


    {% if pos > 3 %}
        <tr>
            <td width="5%" align="left">&nbsp</td>
            <td align="right"><a href="">Xuất ra Excel</a></td>
        </tr>
    {% endif %}
    <input id="reload" type="hidden" onclick="location.replace(location.href)"/>
    </div>
{% endblock %}
